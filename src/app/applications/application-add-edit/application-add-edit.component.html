<div class="top-container" *ngIf="application">
  <div class="container">
    <div class="title-container">
      <div class="title-container__title">
        <h1 class="text-muted" style="margin-left: 6.5rem">Create / Edit FOM</h1>
      </div>
      <div class="title-container__actions">
        <button
          class="btn btn-light"
          type="button"
          title="Cancel changes"
          (click)="cancelChanges()"
        >
          Cancel
        </button>
        <div class="btn-container">
          <button
            class="btn btn-primary ml-1"
            type="button"
            title="Submit new application"
          >
            <i class="spinner rotating" [hidden]="!isSubmitting"></i>
            <span>{{ isSubmitting ? "Submitting" : "Submit" }}</span>
          </button>
          <span title="You cannot save a retired application"></span>
        </div>
        <div class="btn-container">
          <button
            class="btn btn-success ml-1"
            type="button"
            title="Save application"
            (click)="saveApplication()"
            [disabled]="isSaving"
          >
            <i class="spinner rotating" [hidden]="!isSaving"></i>
            <span>{{ isSaving ? "Saving" : "Save" }}</span>
          </button>
          <span title="You cannot save a retired application"></span>
        </div>
        <div class="btn-container">
          <button
            class="publish-btn btn btn-primary ml-1"
            type="button"
            title="Publish changes"
            (click)="saveApplication()"
            [disabled]="isSaving"
          >
            <i class="spinner rotating" [hidden]="!isSaving"></i>
            <span>{{ isSaving ? "Publishing" : "Publish Changes" }}</span>
          </button>
          <span
            title="You cannot publish changes to a retired application"
          ></span>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="bottom-container" *ngIf="application">
  <div class="container">
    <form class="mb-3" #applicationForm="ngForm">
      <fieldset>
        <div class="row">
          <div class="col-md-5">
            <legend>Application Details</legend>
          </div>
          <div class="col-md-2">
            <label for="fsp-id" style="white-space: nowrap;">FSP ID</label>
            <input
              type="number"
              class="form-control"
              id="fsp-id"
              name="fsp-id"
              [(ngModel)]="application.fspId"
            />
          </div>
          <div class="col-md-5">
            <label for="fsp-id" style="white-space: nowrap;">District</label>
            <select class="sort-comments form-control" id="district-list">
              <option value="56">100 Mile House Natural Resource District</option>
              <option value="43">Campbell River Natural Resource District</option>
              <option value="1826">Cariboo-Chilcotin Natural Resource District</option>
              <option value="1828">Cascades Natural Resource District</option>
              <option value="15">Chilliwack Natural Resource District</option>
              <option value="32">Coast Mountains Natural Resource District</option>
              <option value="46">Fort Nelson Natural Resource District</option>
              <option value="48">Haida Gwaii Natural Resource District</option>
            </select>
          </div>
        </div>
        <!-- <legend>Application Details</legend> -->
        <div class="form-group">
          <label>Licensee</label>
          <!-- <div class="applicant-display">
            {{application.meta.applicants || 'Pretty Bird Operations'}}
          </div> -->
          <input
            type="text"
            class="form-control"
            id="client"
            name="client"
            [(ngModel)]="application.forestClient.name"
          />
        </div>
        <div class="form-group">
          <label>FOM Name</label>
          <input
            type="text"
            class="form-control"
            id="name"
            name="name"
            [(ngModel)]="application.name"
          />
        </div>

        <div class="form-group">
          <label>Description</label>
          <textarea
            class="form-control"
            rows="3"
            id="description"
            name="description"
            #description="ngModel"
            [(ngModel)]="application.description"
          >
          </textarea>
        </div>
        <div class="form-group mb-0">
          <legend>FOM Supporting Documents</legend>
          <ul
            class="doc-list mb-3"
          >
            <li *ngFor="let doc of (application['attachments'] || [])">
              <span class="cell icon">
                <i class="material-icons">insert_drive_file</i>
              </span>
              <span class="cell name" [title]="doc.displayName || ''">
                <span class="cell__txt-content">{{
                  doc.documentFileName
                }}</span>
              </span>
              <span class="cell actions">
                <button
                  class="btn btn-icon"
                  type="button"
                  title="Delete this document"
                  (click)="deleteDocument(doc, (application['attachments'] || []))"
                >
                  <i class="material-icons">delete</i>
                </button>
              </span>
            </li>
          </ul>
          <app-file-upload
            *ngIf=" (application['attachments'] || [])"
            [fileExt]="['jpg', 'jpeg', 'png', 'pdf', 'tiff']"
            [maxFiles]="0"
            [maxSize]="10"
            [showList]="false"
            [files]="applicationFiles"
            (filesChange)="
              addDocuments($event,  (application['attachments'] || []));
              applicationFiles = []
            "
          ></app-file-upload>
        </div>
      </fieldset>

      <fieldset name="decisionForm" id="appDecision">
        <!-- <legend class="mb-3">Initial Public Notice</legend> -->
        <legend>Initial Public Notice</legend>
        <!-- <div class="mb-4" *ngIf="application.meta.decision"> -->
        <div class="mb-4">
          <div class="form-group">
            <ul
              class="doc-list mb-3"
            >
              <li *ngFor="let doc of (application['attachments'] || [])">
                <span class="cell icon">
                  <i class="material-icons">insert_drive_file</i>
                </span>
                <span class="cell name" [title]="doc.displayName || ''">
                  <span class="cell__txt-content">
                    {{ doc.documentFileName }}
                  </span>
                </span>
                <span class="cell actions">
                  <button
                    class="btn btn-icon"
                    type="button"
                    title="Delete this document"
                    (click)="
                      deleteDocument(
                        doc,
                        (application['attachments'] || [])
                      )
                    "
                  >
                    <i class="material-icons">delete</i>
                  </button>
                </span>
              </li>
            </ul>
            <app-file-upload
              [fileExt]="['jpg', 'jpeg', 'png', 'pdf', 'tiff']"
              [maxFiles]="0"
              [maxSize]="10"
              [showList]="false"
              [files]="decisionFiles"
              (filesChange)="
                addDocuments($event, (application['attachments'] || []));
                decisionFiles = []
              "
            ></app-file-upload>
          </div>
        </div>
        <!-- <button class="btn content-btn-alt" type="button" title="Add decision documents"
          *ngIf="!application.meta.decision"
          (click)="addDecision()">
          <i class="material-icons md-20">add</i>
          Add Decision Documents
        </button>
        <button class="btn content-btn-alt danger" type="button" title="Remove the decision documents"
          *ngIf="application.meta.decision"
          (click)="deleteDecision()">
          <i class="material-icons md-20">remove</i>
          Remove Decision Documents
        </button> -->
      </fieldset>
    </form>
  </div>
</div>
